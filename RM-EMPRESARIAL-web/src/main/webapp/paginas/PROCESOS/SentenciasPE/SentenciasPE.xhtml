<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      >



    <ui:composition template="/WEB-INF/template.xhtml">

        <ui:define name="title">
            <h:outputText value="Inscripción"></h:outputText>
        </ui:define>

        <ui:define name="content">
            <h:outputStylesheet name="css/textEditor.css" />

            <h:form id="formSentenciasPE">



                <p:panel header="Sentencias Varias" >
                    <p:panelGrid layout="grid" columns="8" style="display: block;text-align: center">
                        <p:outputLabel for="txtNumTramite" value="# Trámite"/>
                        <p:inputText id="txtNumTramite" value="#{controladorSentenciaPE.numeroTramite}" readonly="true"
                                     style="color: #1a237e"/>
                        <p:outputLabel for="txtRepertorio" value="Repertorio"/>
                        <p:inputText id="txtRepertorio" value="#{controladorSentenciaPE.numeroRepertorio}" readonly="true"
                                     style="color: #1a237e"/>
                        <p:outputLabel for="txtFecha" value="Fecha"/>
                        <p:calendar pattern="dd/MM/yyyy" mask="true" id="txtFecha" value="#{controladorSentenciaPE.fecha}" disabled="true" readonly="true"
                                    style="color: #1a237e"/>
                        <p:outputLabel for="txtContrato" value="Contrato"/>
                        <p:inputText id="txtContrato" value="#{controladorSentenciaPE.descripcionContrato}" readonly="true"
                                     style="color: #1a237e" />

                    </p:panelGrid>


                    <p:layout style="min-width:400px;min-height:589px;">
                        <p:layoutUnit position="west" resizable="true" size="480" header="TRÁMITES" minSize="340" maxSize="500" collapsible="true" effect="drop">                                    
                            <p:panel header="" style="height: 552px; ">
                                <h:panelGrid columns="2" >
                                    <p:outputLabel for="txtFechaRepertorio" value="Fecha" />
                                    <p:calendar pattern="dd/MM/yyyy" id="txtFechaRepertorio" value="#{controladorSentenciaPE.fecha}" required="true" label="firstname">
                                        <p:ajax event="dateSelect" listener="#{controladorSentenciaPE.llenarDatos()}" update=":formSentenciasPE"/>
                                    </p:calendar>                                           
                                </h:panelGrid>

                                <h:panelGrid id="panelRep" columns="1">      
                                    <p:dataTable id="tblRepertorios" scrollable="true"  scrollHeight="410" 
                                                 value="#{controladorSentenciaPE.listaRepertorioFecha}" 
                                                 var="repertorio" selectionMode="single" selection="#{repertorio}" 
                                                 rowKey="#{repertorio.traNumero.traNumero}" sortBy="#{repertorio.traNumero.traNumero}" > 
                                        <p:ajax event="rowSelect" listener="#{controladorSentenciaPE.onRowSelect}"  

                                                update=" :formSentenciasPE" />
                                        <p:column headerText="# Trámite" groupRow="true">
                                            <h:outputText value="#{repertorio.traNumero.traNumero}" />
                                        </p:column>
                                        <p:column headerText="Repertorio" >
                                            <h:outputText value="#{repertorio.repNumero}" />
                                        </p:column>                                              

                                        <p:column headerText="Contrato">
                                            <h:outputText value="#{repertorio.repTtrDescripcion}" />
                                        </p:column>
                                        <p:column headerText="Estado">
                                            <h:outputText value="#{repertorio.estadoProceso}" />
                                        </p:column>
                                        <p:column headerText="TERMINAR" groupRow="true">
                                            <p:commandButton value="TERMINAR #{repertorio.traNumero.traNumero}" class="yellow-btn"
                                                             update="growl formSentenciasPE"

                                                             actionListener="#{controladorSentenciaPE.terminarProceso(repertorio.traNumero)}"
                                                             />

                                        </p:column>
                                    </p:dataTable>

                                </h:panelGrid>


                            </p:panel>

                        </p:layoutUnit>
                        <p:layoutUnit position="center" resizable="true" size="680" minSize="680" maxSize="700">

                            <p:panel rendered="#{controladorSentenciaPE.renderedPanel}">
                                <p:commandButton action="#{controladorSentenciaPE.procesoTerminar()}"
                                                 update=":formSentenciasPE, growl" 
                                                 value="Terminar" immediate="true" process="@this"
                                                 disabled="#{controladorSentenciaPE.deshabilitarBoton}"
                                                 class="green-btn" style="margin-right:20px;" icon="fa fa-save" title="Terminar" >
                                 <p:confirm header="Confirmación" message="Se aplicará la Posesión Efectiva ¿Desea Continuar?" icon="fa fa-exclamation-triangle" />
                                </p:commandButton>


                                <p:commandButton  value="Suspensión" process="@this" immediate="true"
                                                  class="red-btn"
                                                  oncomplete="PF('dlgRznSus').show()" update="formRazonesSuspension" icon="fa fa-ban"
                                                  rendered="#{controladorSentenciaPE.renderedBtnSuspension}"
                                                  disabled="#{controladorSentenciaPE.numeroTramite eq null}">
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.numProforma}"
                                                                 value="#{controladorSentenciaPE.numeroTramite}"/>
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.numeroRepertorio}"
                                                                 value="#{controladorSentenciaPE.numeroRepertorio}"/>
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.numTramite}"
                                                                 value="#{controladorSentenciaPE.numeroTramite}"/>
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.listaPropietarioPropiedad}"
                                                                 value="#{controladorSentenciaPE.listaPropiedadPorMatricula}"/>
                                </p:commandButton>

                            </p:panel>

                            <p:panel header="" id="scrollPanel" rendered="#{controladorSentenciaPE.renderedPanel}" 
                                     style="width: 680px; height: 500px; ">



                                <div align="center">
                                    <p:outputLabel style="font-weight: bold;" value="MATRÍCULAS" />
                                </div> 

                                <h:panelGrid id="panelVerMatriculas" columns="2" width="650">      
                                    <p:dataTable id="tblMatriculas" scrollable="true" scrollHeight="150" 
                                                 value="#{controladorSentenciaPE.listaPropiedadPorMatricula}"
                                                 var="propietario" sortBy="#{propietario.prdMatricula.prdMatricula}" > 

                                        <p:column  groupRow="true" headerText="Matrícula" width="80">
                                            <h:outputText value="#{propietario.prdMatricula.prdMatricula}" />
                                        </p:column>

                                        <p:column groupRow="true" headerText="Descripción" width="230">
                                            <h:outputText value="#{propietario.prdMatricula.prdDescripcion2}" />
                                        </p:column>

                                        <p:column headerText="Propietario" >
                                            <h:outputText value="#{propietario.pprPerNombre.trim()} #{propietario.pprPerApellidoPaterno.trim()} #{propietario.ppPerApellidoMaterno.trim()}" />
                                        </p:column>
                                        <p:column headerText="" style="text-align: center;" groupRow="true" width="100">
                                            <p:commandButton title="Derechos y Acciones" class="cyan-btn"
                                                             icon="fa fa-file-text-o"
                                                             update=":formDerechosAcciones"
                                                             value="#{propietario.prdMatricula.prdMatricula}"
                                                             action="#{controladorSentenciaPE.cargarPropiedadDetalle()}"
                                                             oncomplete ="PF('dlgPropiedadesDerAcc').show()" >
                                                <f:setPropertyActionListener target="#{controladorSentenciaPE.propiedadMatriculaDerAcc}"
                                                                             value="#{propietario.prdMatricula}"/>
                                            </p:commandButton>                                                    
                                        </p:column>





                                    </p:dataTable>



                                </h:panelGrid>

                                <h:panelGrid columns="2">

                                    <p:outputLabel style="font-weight: bold;"  value="COMPARECIENTES" />

                                    <p:commandButton  oncomplete ="PF('dlgComparecientes').show()"
                                                      update ="formComparecientes" class="green-btn"
                                                      disabled="#{controladorSentenciaPE.deshabilitarBoton}"
                                                      immediate="true" process="@this" 
                                                      action="#{controladorSentenciaPE.cargarTablaComparecientes()}"
                                                      style="margin-right:20px;" icon="fa fa-plus"
                                                      title="Agregar Compareciente" />

                                </h:panelGrid>


                                <h:panelGrid id="panelComparecientes" columns="2" width="650">      
                                    <p:dataTable id="tblComparecientes" scrollable="true" scrollHeight="150"
                                                 value="#{controladorSentenciaPE.listaTramiteDetalle}"
                                                 var="compareciente" sortBy="#{compareciente.tdtPerTipoIdentificacion}" > 



                                        <p:column headerText="IDENTIFICACIÓN" width="115">
                                            <h:outputText value="#{compareciente.tdtPerIdentificacion}" />
                                        </p:column>
                                        <p:column headerText="NOMBRES " width="220">
                                            <h:outputText value="#{compareciente.tdtPerNombre.trim()} #{compareciente.tdtPerApellidoPaterno.trim()} #{compareciente.tdtPerApellidoMaterno.trim()}" />
                                        </p:column>
                                        <p:column headerText="TIPO" width="120">
                                            <h:outputText value="#{compareciente.ttcId.tpcId.tpcDescripcion}" />
                                        </p:column>

                                        <p:column headerText="PROPIEDADES" style="text-align: center;">
                                            <p:commandButton title="Seleccionar Propiedades" class="green-btn"
                                                             icon="fa fa-home" disabled="#{compareciente.ttcId.ttcPropietario eq 'N'}"
                                                             update="dlgFormPropiedad"
                                                             oncomplete ="PF('dlgPropiedades').show()"
                                                             action="#{controladorSentenciaPE.seleccionarPropiedades(compareciente.perId.perId)}"/>                                                    
                                        </p:column>



                                    </p:dataTable>
                                </h:panelGrid>

                            </p:panel>
                            <p:panel rendered="#{controladorSentenciaPE.renderedPanelTab}"
                                     style="width: 680px; height: 551px; ">

                                <p:commandButton  value="Suspensión" process="@this" immediate="true"
                                                  action="#{controladorSentenciaPE.listarTipoSuspencion()}"  class="red-btn"
                                                  oncomplete="PF('dlgRznSus').show()" update="formRazonesSuspension" icon="fa fa-ban"
                                                  rendered="#{controladorSentenciaPE.renderedBtnSuspension}"
                                                  disabled="#{controladorSentenciaPE.numeroTramite eq null}">
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.numProforma}"
                                                                 value="#{controladorSentenciaPE.numeroTramite}"/>
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.numeroRepertorio}"
                                                                 value="#{controladorSentenciaPE.numeroRepertorio}"/>
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.numTramite}"
                                                                 value="#{controladorSentenciaPE.numeroTramite}"/>
                                    <f:setPropertyActionListener target="#{controladorSentenciaPESuspension.listaPropietarioPropiedad}"
                                                                 value="#{controladorSentenciaPE.listaPropiedadPorMatricula}"/>


                                </p:commandButton>

                                <p:tabView id="tabView" activeIndex="#{controladorSentenciaPE.activeIndex}"
                                           rendered="#{controladorSentenciaPE.renderedTabView}">


                                    <p:tab title="Datos Generales" 
                                           rendered="#{controladorSentenciaPE.renderedTabDatosGen}"
                                           disabled="#{controladorSentenciaPE.deshabilitarTabDatosGen}" >
                                        <h:form id="formDatosGenerales">
                                            <h:panelGrid columns="2" cellpadding="4">
                                                <p:outputLabel for="txtParroquia" value="Parroquia" />
                                                <p:inputText id="txtParroquia" style="width: 450px;text-transform: uppercase;"
                                                             required="true" requiredMessage="Ingrese la parroquia"
                                                             value="#{controladorSentenciaPE.parroquias}"/>

                                                <p:outputLabel for="txtDescripcion" value="Descripcion"/>
                                                <p:inputText id="txtDescripcion" style="width: 450px;text-transform: uppercase;"
                                                             required="true" requiredMessage="Ingrese la descripción de la parroquia"
                                                             value="#{controladorSentenciaPE.descripcionParroquia}"/>
                                            </h:panelGrid>
                                            <h:panelGrid columns="4" cellpadding="4">
                                                <p:outputLabel for="txtTipoContrato" value="Tipo de Contrato"/>
                                                <p:inputText id="txtTipoContrato" readonly="true"
                                                             required="true" requiredMessage="Seleccione un contrato"
                                                             value="#{controladorSentenciaPE.descripcionContrato}"/>
                                                <p:outputLabel for="fechaIngreso" value="Fecha de Ingreso"/>
                                                <p:calendar pattern="dd/MM/yyyy" mask="true" id="fechaIngreso"
                                                            required="true" requiredMessage="Verifique que el repertorio tenga una fecha para la fecha de Ingreso"
                                                            value="#{controladorSentenciaPE.fechaIngreso}" 
                                                            readonly="true" disabled="false" showOn="false"/>
                                                <p:outputLabel for="fechaDe" value="Fecha Auto"/>
                                                <p:calendar pattern="dd/MM/yyyy" mask="true" id="fechaDe"
                                                            required="true" requiredMessage="Seleccione la Fecha De"
                                                            value="#{controladorSentenciaPE.fechaDe}"
                                                            style="color: #1a237e"/>
                                                <p:outputLabel for="txtFechaSentencia" value="Fecha de Sentencia"/>
                                                <p:calendar pattern="dd/MM/yyyy" mask="true" id="txtFechaSentencia"
                                                            maxdate="#{controladorSentenciaPE.fechaIngreso}"
                                                            required="true" requiredMessage="Seleccione la Fecha de Sentencia"
                                                            value="#{controladorSentenciaPE.fechaSentencia}"
                                                            style="color: #1a237e"/>
                                                <p:outputLabel for="txtTipoJuicio" value="Tipo de Juicio"/>
                                                <p:selectOneMenu id="txtTipoJuicio" value="#{controladorSentenciaPE.tipoJuicioId}"
                                                                 required="true" requiredMessage="Seleccione el Tipo de Juicio">
                                                    <f:selectItems value="#{controladorSentenciaPE.listaTipoJuicio}"
                                                                   var="tipoJuicio" 
                                                                   itemValue="#{tipoJuicio.tpjId}"
                                                                   itemLabel="#{tipoJuicio.tpjDescripcion}"                                            

                                                                   />

                                                </p:selectOneMenu>
                                                <p:outputLabel for="txtNumeroJuicio" value="Número de Juicio"/>
                                                <p:inputText id="txtNumeroJuicio" 
                                                             required="true" requiredMessage="Ingrese el Número de Juicio"
                                                             value="#{controladorSentenciaPE.numeroJuicio}"/>
                                            </h:panelGrid>
                                            <h:panelGrid columns="2" cellpadding="4">
                                                <p:outputLabel for="txtJuzgado" value="Juzgado"/>
                                                <p:inputText id="txtJuzgado" style="width: 450px"
                                                             required="true" requiredMessage="Ingrese el Número de Juzgado"
                                                             value="#{controladorSentenciaPE.juzgado}"/>
                                                <p:outputLabel for="txtNotaria" value="Notaria"/>
                                                <p:inputText id="txtNotaria" style="width: 450px"
                                                             required="true" requiredMessage="Ingrese el Número de Notaria"
                                                             value="#{controladorSentenciaPE.notaria}"/>
                                                <p:outputLabel for="txtNumeroOficio" value="Número de Oficio"/>
                                                <p:inputText id="txtNumeroOficio" style="width: 450px"
                                                             required="true" requiredMessage="Ingrese el Número de Oficio"
                                                             value="#{controladorSentenciaPE.numeroOficio}"/>
                                                <p:outputLabel for="txtObservacion" value="Observación"/>
                                                <p:inputText id="txtObservacion" style="width: 450px;text-transform: uppercase;"
                                                             required="true" requiredMessage="Ingrese la Observación"
                                                             value="#{controladorSentenciaPE.observacion}"/>
                                            </h:panelGrid>
                                            <p:commandButton action="#{controladorSentenciaPE.guardarActa()}"
                                                             update="growl formSentenciasPE formDatosGenerales " 
                                                             value="Guardar"  process="formDatosGenerales"                                                       
                                                             class="green-btn" style="margin-right:20px;" icon="fa fa-save" title="Guardar" />


                                        </h:form>

                                    </p:tab>
                                    <p:tab title="Acta" 
                                           rendered="#{controladorSentenciaPE.renderedTabActa}"
                                           disabled="#{controladorSentenciaPE.deshabilitarTabActa}">
                                        <h:form id="formActa">
                                            <p:commandButton action="#{controladorSentenciaPE.previsualizarActa()}"
                                                             update="growl :formPrevisualizar"
                                                             value ="Previsualizar Acta"
                                                             class="blue-btn" process="@form"                                          
                                                             style="margin-right:20px;" icon="fa fa-file-o" title="Previsualizar Acta"
                                                             />
                                            <p:commandButton action="#{controladorSentenciaPE.sobreEscribirActa()}"
                                                             disabled="#{controladorSentenciaPE.deshabilitarBotonGuardar}"
                                                             update=":formSentenciasPE growl " 
                                                             value="Guardar Acta"  process="formActa"                                                       
                                                             class="green-btn" style="margin-right:20px;" icon="fa fa-save" title="Guardar Acta" />
                                            <h:panelGrid columns="1" cellpadding="10">
                                                <p:textEditor toolbarVisible="false" id="txtActaCabecera" 
                                                              widgetVar="actaCabecera" value="#{controladorSentenciaPE.cabeceraActa}" 
                                                              height="185" style="margin-bottom:10px; width: 620px; text-align: justify;"                                                          
                                                              readonly="true"/>

                                                <p:textEditor toolbarVisible="false" id="txtActaCuerpo" 
                                                              widgetVar="actaCuerpo" value="#{controladorSentenciaPE.cuerpoActa}" 
                                                              height="240" style="margin-bottom:10px; width: 620px; text-align: justify;"
                                                              required="true" requiredMessage="El campo Cuerpo Acta es requerido"
                                                              readonly="false"/>

                                            </h:panelGrid>

                                        </h:form>
                                    </p:tab>
                                    <p:tab title="Razón" 
                                           rendered="#{controladorSentenciaPE.renderedTabRazon}"
                                           disabled="#{controladorSentenciaPE.deshabilitarTabRazon}">
                                        <h:form id="formRazon">
                                            <p:commandButton action="#{controladorSentenciaPE.guardar()}"
                                                             update=":formSentenciasPE growl " 
                                                             value="Guardar Razón"     process="formRazon"                                                  
                                                             class="green-btn" style="margin-right:20px;" icon="fa fa-save" title="Guardar Razón" />
                                            <div align="center">
                                                <p:commandButton  
                                                    icon="fa fa-plus" 
                                                    actionListener="#{controladorSentenciaPE.sumarSaltoLineaRazon()}"
                                                    style="margin-top: 5px"
                                                    process="@this"
                                                    update="growl :formSentenciasPE:tabView" >
                                                </p:commandButton>

                                                <p:commandButton  
                                                    icon="fa fa-minus" 
                                                    actionListener="#{controladorSentenciaPE.restarSaltoLineaRazon()}"
                                                    style="margin-top: 5px"
                                                    process="@this"
                                                    update="growl  :formSentenciasPE:tabView"
                                                    >
                                                </p:commandButton>
                                                <p:selectBooleanButton value="#{controladorSentenciaPE.bolAgregarImagenEspacioEnBlancoRazon}"
                                                                       onLabel="Con Imagen Texto En Blanco"
                                                                       offLabel="Sin Imagen Texto En Blanco">
                                                    <p:ajax listener="#{controladorSentenciaPE.agregarImagenBlancoRazon()}"
                                                            update="growl  :formSentenciasPE:tabView"/>
                                                </p:selectBooleanButton>
                                            </div>
                                            <h:panelGrid columns="1" cellpadding="10">          
                                                <p:media id="pdfRazon"
                                                         value="#{controladorSentenciaPE.urlRazonPdf}"
                                                         rendered="#{not empty controladorSentenciaPE.urlRazonPdf}"
                                                         style="width:600px;height: 400px"
                                                         player="pdf"  />
                                               
                                            </h:panelGrid>


                                        </h:form>
                                    </p:tab>
                                </p:tabView>
                            </p:panel>


                        </p:layoutUnit>
                    </p:layout> 
                </p:panel>
            </h:form>

            <!-- DIALOGO PREVISUALIZAR ACTA -->

            <p:dialog id="dlgFormPreViewActa" widgetVar="dlgPreviewActa" modal="true"
                      onShow="PF('dlgPreviewActa').initPosition()" header="Previsualizar Acta" >

                <h:form id="formPrevisualizar">
                    <div align="center">
                        <div align="center">
                            <p:commandButton  
                                icon="fa fa-plus" 
                                actionListener="#{controladorSentenciaPE.sumarSaltoLinea()}"
                                style="margin-top: 5px"
                                process="@this"
                                update="growl formPrevisualizar" >
                            </p:commandButton>

                            <p:commandButton  
                                icon="fa fa-minus" 
                                actionListener="#{controladorSentenciaPE.restarSaltoLinea()}"
                                style="margin-top: 5px"
                                process="@this"
                                update="growl  formPrevisualizar"
                                >
                            </p:commandButton>
                            <p:selectBooleanButton value="#{controladorSentenciaPE.bolAgregarImagenEspacioEnBlancoActa}"
                                                   onLabel="Con Imagen Texto En Blanco"
                                                   offLabel="Sin Imagen Texto En Blanco">
                                <p:ajax listener="#{controladorSentenciaPE.agregarImagenBlancoActa()}"
                                        update="growl  formPrevisualizar"/>
                            </p:selectBooleanButton>
                            <p:commandButton class="green-btn" value="Aceptar" immediate="true" 
                                             action="#{controladorSentenciaPE.habilitarGuardar()}"
                                             oncomplete="PF('dlgPreviewActa').hide()"
                                             icon="fa fa-check"
                                             update=":formSentenciasPE:tabView"/>
                        </div>
                    </div>

                    <br></br>
                    <h:panelGroup >                       
                        <p:media id="pdfActa"
                                 value="#{controladorSentenciaPE.urlActaPdf}"
                                 rendered="#{not empty controladorSentenciaPE.urlActaPdf}"
                                 style="width:700px;height: 500px"
                                 player="pdf"  />
                    </h:panelGroup>
                </h:form>
            </p:dialog>



            <p:dialog id="dlgFormComparecientes" widgetVar="dlgComparecientes" modal="true"
                      onShow="PF('dlgComparecientes').initPosition()" header="Comparecientes" >

                <h:form id="formComparecientes">
                    <h:panelGroup >    
                        <h:panelGrid id="panelGridCompareciente" columns="7" >
                            <p:outputLabel value="Identificación"/>
                            <p:inputText id="txtIdentificacion" required="true" requiredMessage="Ingrese la identificación"
                                         title="Identificación"  
                                         value="#{controladorSentenciaPE.tramitesControladorBb.identificacion}" >
                                <p:ajax listener="#{controladorSentenciaPE.buscarPersona()}" 
                                        update="growl panelGridCompareciente"  
                                        process="txtIdentificacion" event="change" 
                                        />
                            </p:inputText>

                            <p:inputText value="#{controladorSentenciaPE.tramitesControladorBb.nombrePersona}"
                                         style="width: 250px" readonly="true"/>

                            <p:selectOneMenu id="tipoCompareciente" value="#{controladorSentenciaPE.tipoComparecienteId}">
                                <f:selectItems value="#{controladorSentenciaPE.listaTipoCompareciente}"
                                               var="tipoComp" 
                                               itemValue="#{tipoComp.tpcId}"
                                               itemLabel="#{tipoComp.tpcDescripcion}"                                            

                                               />

                            </p:selectOneMenu>
                            <p:commandButton  
                                action="#{controladorSentenciaPE.guardarTramiteDetalle()}"
                                class="green-btn"
                                style="margin-right:20px;" icon="fa fa-plus"
                                title="Agregar Compareciente" 
                                update="growl formSentenciasPE formComparecientes"/>

                            <p:commandButton title="Buscar Persona" icon="fa fa-search" value="Buscar"
                                             class="orange-btn" immediate="true" process="@this" 
                                             actionListener="#{controladorFiltradoPersona.prepararFiltrado('CtrlSPE', 'formComparecientes')}"
                                             oncomplete ="PF('dlgFiltradoPersona').show()"/>


                            <p:commandButton title="Crear Nueva Persona" icon="fa fa-user-plus" 
                                             oncomplete ="PF('dlgNuevaPersona').show()"/>


                        </h:panelGrid>  
                        <div align="center" >


                            <h:panelGrid id="panelComparecientes" columns="2" width="650">      
                                <p:dataTable id="tblComparecientes"  scrollable="true" scrollHeight="150"
                                             value="#{controladorSentenciaPE.listaTramiteDetalle}"
                                             var="compareciente" sortBy="#{compareciente.tdtPerIdentificacion}" > 

                                    <p:column headerText="IDENTIFICACIÓN" width="120">
                                        <h:outputText value="#{compareciente.tdtPerIdentificacion}" />
                                    </p:column>
                                    <p:column headerText="NOMBRES" width="220">
                                        <h:outputText value="#{compareciente.tdtPerNombre.trim()} #{compareciente.tdtPerApellidoPaterno.trim()} #{compareciente.tdtPerApellidoMaterno.trim()}" />
                                    </p:column>

                                    <p:column headerText="TIPO" width="170">
                                        <h:outputText value="#{compareciente.ttcId.tpcId.tpcDescripcion}" />
                                    </p:column>

                                    <p:column headerText="" style="text-align: center;">
                                        <p:commandButton  
                                            action="#{controladorSentenciaPE.eliminarCompareciente(compareciente.tdtId)}"
                                            class="red-btn" immediate="true" 
                                            style="margin-right:20px;" icon="fa fa-remove"
                                            title="Eliminar Compareciente" 
                                            update="growl :formSentenciasPE formComparecientes"/>

                                    </p:column>
                                </p:dataTable>
                            </h:panelGrid>


                        </div>

                        <p:commandButton class="red-btn" icon="fa fa-close" value="Salir" immediate="true" onclick="PF('dlgComparecientes').hide()"/>
                    </h:panelGroup>
                </h:form>
            </p:dialog>

            <p:dialog id="dlgFormPropiedad" widgetVar="dlgPropiedades" modal="true"
                      onShow="PF('dlgPropiedades').initPosition()" header="Seleccionar Propiedades" >

                <h:form id="formPropiedades">
                    <h:panelGroup >   
                        <div align="center" >
                            <h:panelGrid id="panelPropiedades" columns="2" width="810">      
                                <p:dataTable id="tblComparecientes"  scrollable="true" scrollHeight="150"
                                             value="#{controladorSentenciaPE.listaPropiedad}"
                                             var="propiedad" sortBy="#{propiedad.prdMatricula}" rowKey="#{propiedad.prdMatricula}"
                                             selection="#{controladorSentenciaPE.listaPropiedadesSeleccionadas}" >
                                    <p:column selectionMode="multiple" style="width:16px;text-align:center"/>                                                
                                    <p:column headerText="Nro. Matrícula">
                                        <h:outputText value="#{propiedad.prdMatricula}" />
                                    </p:column>
                                    <p:column headerText="Catastro" >
                                        <h:outputText value="#{propiedad.prdCatastro}" />
                                    </p:column>
                                    <p:column headerText="Predio" >
                                        <h:outputText value="#{propiedad.prdPredio}" />
                                    </p:column>
                                    <p:column headerText="Parroquia">
                                        <h:outputText value="#{propiedad.prdTdtParNombre}" />
                                    </p:column>                                                

                                </p:dataTable>
                            </h:panelGrid>


                        </div>
                        <p:commandButton  
                            action="#{controladorSentenciaPE.guardarPropiedades()}"
                            class="green-btn" value="Guardar"
                            style="margin-right:20px;" icon="fa fa-save"
                            title="Guardar Propiedades" 
                            update="growl formSentenciasPE formComparecientes"/>

                        <p:commandButton class="red-btn" icon="fa fa-close" value="Cancelar" immediate="true" onclick="PF('dlgPropiedades').hide()"/>
                    </h:panelGroup>
                </h:form>
            </p:dialog>


            <p:dialog id="dlgFormPropiedadesDerAcc" widgetVar="dlgPropiedadesDerAcc" modal="true" width="900"
                      onShow="PF('dlgPropiedadesDerAcc').initPosition()" header="Seleccionar Derechos y Acciones" >

                <h:form id="formDerechosAcciones">


                    <h:panelGrid columns="5">

                        <p:commandButton icon="fa fa-plus" immediate="true" process="@this"
                                         action="#{controladorSentenciaPE.preCrearDetallePropiedad()}"
                                         oncomplete="PF('dialogoDereAccn').show();" 
                                         disabled="#{controladorSentenciaPE.disabledBtnAgregarDerAcc }"
                                         update=":frmDerAcc"
                                         value="Agregar"
                                         title="Agregar un derecho y acción"
                                         /> 
                        <p:commandButton icon="fa fa-save" immediate="true" process="@this"
                                         class="green-btn"
                                         action="#{controladorSentenciaPE.guardarDerAcc()}"
                                         update="growl" 
                                         value="Guardar"
                                         disabled="#{controladorSentenciaPE.disabledBtnGuardarDerAcc }"
                                         title="Guardar los derechos y acciones"
                                         /> 
                    </h:panelGrid>


                    <p:dataTable id="dtb_prop_deta" scrollable="true" scrollHeight="300"
                                 value="#{controladorSentenciaPE.listaPropiedadDetalle}" 
                                 var="item" rowKey="#{item.pdtId}" rowIndexVar="row" >
                        <p:column headerText="Código" style="width: 30px;">
                            <h:outputText value="#{row+1}"/>
                        </p:column>
                        <p:column headerText="Derechos" filterBy="" filterMatchMode="contains" style="width: 50px;">
                            <h:outputText value="#{item.pdtValor}"/>
                        </p:column>
                        <p:column headerText="Descripción" style="width: 250px;">
                            <h:outputText value="#{item.pdtDescripcion}"/>
                        </p:column>
                        <p:column headerText="Cédula/RUC" filterBy="" filterMatchMode="contains" style="width: 60px;">
                            <h:outputText value="#{item.persona.perIdentificacion}"/>
                        </p:column>

                        <p:column headerText="Nombre" filterBy="" filterMatchMode="contains" style="width: 60px;">
                            <h:outputText value="#{item.persona.perNombre}"/>
                        </p:column>
                        <p:column headerText="A. Paterno" filterBy="" filterMatchMode="contains" style="width: 60px;">
                            <h:outputText value="#{item.persona.perApellidoPaterno}"/>
                        </p:column>

                        <p:column style="width: 70px;">
                            <p:commandButton action="#{controladorSentenciaPE.borrarDetallePropiedad(row)}"
                                             class="red-btn" icon="fa fa-trash" value="Eliminar" 
                                             process="@this" immediate="true" update="@form"
                                             disabled="#{controladorSentenciaPE.verificarExiste(item.pdtPerId)}"
                                             >
                                <f:setPropertyActionListener target="#{controladorSentenciaPE.propiedadDetalleSeleccionada}"
                                                             value="#{item}"/>

                                <f:setPropertyActionListener target="#{controladorSentenciaPE.propiedadDetElim}"
                                                             value="#{item}"/>

                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </h:form>




            </p:dialog>            


            <!--  <ui:include src="/paginas/PROCESOS/persona/persona.xhtml"/>-->
            <ui:include src="/paginas/PROCESOS/SentenciasPE/suspension.xhtml"/>
            <ui:include src="/paginas/PROCESOS/SentenciasPE/DerechosYacciones.xhtml"/>
            <ui:include src="/paginas/FiltradoPersona.xhtml"/>

        </ui:define>
    </ui:composition>

</html>
